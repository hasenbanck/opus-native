//! Implements the mode that CELT supports. Custom modes are not supported.

use crate::celt::kiss_fft::{KissFft, Twiddle};
use crate::celt::mdct::Mdct;

const ALLOC_VECTORS: [u8; 231] = [
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 90, 80, 75, 69, 63, 56, 49, 40,
    34, 29, 20, 18, 10, 0, 0, 0, 0, 0, 0, 0, 0, 110, 100, 90, 84, 78, 71, 65, 58, 51, 45, 39, 32,
    26, 20, 12, 0, 0, 0, 0, 0, 0, 118, 110, 103, 93, 86, 80, 75, 70, 65, 59, 53, 47, 40, 31, 23,
    15, 4, 0, 0, 0, 0, 126, 119, 112, 104, 95, 89, 83, 78, 72, 66, 60, 54, 47, 39, 32, 25, 17, 12,
    1, 0, 0, 134, 127, 120, 114, 103, 97, 91, 85, 78, 72, 66, 60, 54, 47, 41, 35, 29, 23, 16, 10,
    1, 144, 137, 130, 124, 113, 107, 101, 95, 88, 82, 76, 70, 64, 57, 51, 45, 39, 33, 26, 15, 1,
    152, 145, 138, 132, 123, 117, 111, 105, 98, 92, 86, 80, 74, 67, 61, 55, 49, 43, 36, 20, 1, 162,
    155, 148, 142, 133, 127, 121, 115, 108, 102, 96, 90, 84, 77, 71, 65, 59, 53, 46, 30, 1, 172,
    165, 158, 152, 143, 137, 131, 125, 118, 112, 106, 100, 94, 87, 81, 75, 69, 63, 56, 45, 20, 200,
    200, 200, 200, 200, 200, 200, 200, 198, 193, 188, 183, 178, 173, 168, 163, 158, 153, 148, 129,
    104,
];

const E_BAND: [u8; 22] = [
    0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 16, 20, 24, 28, 34, 40, 48, 60, 78, 100,
];

const LOG_N: [u8; 21] = [
    0, 0, 0, 0, 0, 0, 0, 0, 8, 8, 8, 8, 16, 16, 16, 21, 21, 24, 29, 34, 36,
];

#[rustfmt::skip]
#[allow(clippy::excessive_precision)]
const WINDOW: [f32; 120] = [
    6.7286966e-05, 0.00060551348, 0.0016815970, 0.0032947962, 0.0054439943,
    0.0081276923, 0.011344001, 0.015090633, 0.019364886, 0.024163635,
    0.029483315, 0.035319905, 0.041668911, 0.048525347, 0.055883718,
    0.063737999, 0.072081616, 0.080907428, 0.090207705, 0.099974111,
    0.11019769, 0.12086883, 0.13197729, 0.14351214, 0.15546177,
    0.16781389, 0.18055550, 0.19367290, 0.20715171, 0.22097682,
    0.23513243, 0.24960208, 0.26436860, 0.27941419, 0.29472040,
    0.31026818, 0.32603788, 0.34200931, 0.35816177, 0.37447407,
    0.39092462, 0.40749142, 0.42415215, 0.44088423, 0.45766484,
    0.47447104, 0.49127978, 0.50806798, 0.52481261, 0.54149077,
    0.55807973, 0.57455701, 0.59090049, 0.60708841, 0.62309951,
    0.63891306, 0.65450896, 0.66986776, 0.68497077, 0.69980010,
    0.71433873, 0.72857055, 0.74248043, 0.75605424, 0.76927895,
    0.78214257, 0.79463430, 0.80674445, 0.81846456, 0.82978733,
    0.84070669, 0.85121779, 0.86131698, 0.87100183, 0.88027111,
    0.88912479, 0.89756398, 0.90559094, 0.91320904, 0.92042270,
    0.92723738, 0.93365955, 0.93969656, 0.94535671, 0.95064907,
    0.95558353, 0.96017067, 0.96442171, 0.96834849, 0.97196334,
    0.97527906, 0.97830883, 0.98106616, 0.98356480, 0.98581869,
    0.98784191, 0.98964856, 0.99125274, 0.99266849, 0.99390969,
    0.99499004, 0.99592297, 0.99672162, 0.99739874, 0.99796667,
    0.99843728, 0.99882195, 0.99913147, 0.99937606, 0.99956527,
    0.99970802, 0.99981248, 0.99988613, 0.99993565, 0.99996697,
    0.99998518, 0.99999457, 0.99999859, 0.99999982, 1.0000000
];

#[rustfmt::skip]
#[allow(clippy::excessive_precision)]
const TWIDDLES: [f32; 1800] = [
    0.99999994, 0.99999321, 0.99997580, 0.99994773, 0.99990886,
    0.99985933, 0.99979913, 0.99972820, 0.99964654, 0.99955416,
    0.99945110, 0.99933738, 0.99921292, 0.99907774, 0.99893188,
    0.99877530, 0.99860805, 0.99843007, 0.99824142, 0.99804211,
    0.99783206, 0.99761140, 0.99737996, 0.99713790, 0.99688518,
    0.99662173, 0.99634761, 0.99606287, 0.99576741, 0.99546129,
    0.99514455, 0.99481714, 0.99447906, 0.99413031, 0.99377096,
    0.99340093, 0.99302030, 0.99262899, 0.99222708, 0.99181455,
    0.99139136, 0.99095762, 0.99051321, 0.99005818, 0.98959261,
    0.98911643, 0.98862964, 0.98813224, 0.98762429, 0.98710573,
    0.98657662, 0.98603696, 0.98548669, 0.98492593, 0.98435456,
    0.98377270, 0.98318028, 0.98257732, 0.98196387, 0.98133987,
    0.98070538, 0.98006040, 0.97940493, 0.97873890, 0.97806245,
    0.97737551, 0.97667813, 0.97597027, 0.97525197, 0.97452319,
    0.97378403, 0.97303438, 0.97227436, 0.97150391, 0.97072303,
    0.96993178, 0.96913016, 0.96831810, 0.96749574, 0.96666300,
    0.96581990, 0.96496642, 0.96410263, 0.96322852, 0.96234411,
    0.96144938, 0.96054435, 0.95962906, 0.95870346, 0.95776761,
    0.95682150, 0.95586514, 0.95489854, 0.95392174, 0.95293468,
    0.95193744, 0.95093000, 0.94991243, 0.94888461, 0.94784665,
    0.94679856, 0.94574034, 0.94467193, 0.94359344, 0.94250488,
    0.94140619, 0.94029742, 0.93917859, 0.93804967, 0.93691075,
    0.93576175, 0.93460274, 0.93343377, 0.93225473, 0.93106574,
    0.92986679, 0.92865789, 0.92743903, 0.92621022, 0.92497152,
    0.92372292, 0.92246443, 0.92119598, 0.91991776, 0.91862965,
    0.91733170, 0.91602397, 0.91470635, 0.91337901, 0.91204184,
    0.91069490, 0.90933824, 0.90797186, 0.90659571, 0.90520984,
    0.90381432, 0.90240908, 0.90099424, 0.89956969, 0.89813554,
    0.89669174, 0.89523834, 0.89377540, 0.89230281, 0.89082074,
    0.88932908, 0.88782793, 0.88631725, 0.88479710, 0.88326746,
    0.88172835, 0.88017982, 0.87862182, 0.87705445, 0.87547767,
    0.87389153, 0.87229604, 0.87069118, 0.86907703, 0.86745358,
    0.86582077, 0.86417878, 0.86252749, 0.86086690, 0.85919720,
    0.85751826, 0.85583007, 0.85413277, 0.85242635, 0.85071075,
    0.84898609, 0.84725231, 0.84550947, 0.84375757, 0.84199661,
    0.84022665, 0.83844769, 0.83665979, 0.83486289, 0.83305705,
    0.83124226, 0.82941860, 0.82758605, 0.82574469, 0.82389444,
    0.82203537, 0.82016748, 0.81829083, 0.81640542, 0.81451124,
    0.81260836, 0.81069672, 0.80877650, 0.80684757, 0.80490994,
    0.80296379, 0.80100900, 0.79904562, 0.79707366, 0.79509324,
    0.79310423, 0.79110676, 0.78910083, 0.78708643, 0.78506362,
    0.78303236, 0.78099275, 0.77894479, 0.77688843, 0.77482378,
    0.77275085, 0.77066964, 0.76858020, 0.76648247, 0.76437658,
    0.76226246, 0.76014024, 0.75800985, 0.75587130, 0.75372469,
    0.75157005, 0.74940729, 0.74723655, 0.74505776, 0.74287105,
    0.74067634, 0.73847371, 0.73626316, 0.73404479, 0.73181850,
    0.72958434, 0.72734243, 0.72509271, 0.72283524, 0.72057003,
    0.71829706, 0.71601641, 0.71372813, 0.71143216, 0.70912862,
    0.70681745, 0.70449871, 0.70217246, 0.69983864, 0.69749737,
    0.69514859, 0.69279242, 0.69042879, 0.68805778, 0.68567938,
    0.68329364, 0.68090063, 0.67850029, 0.67609268, 0.67367786,
    0.67125577, 0.66882652, 0.66639012, 0.66394657, 0.66149592,
    0.65903819, 0.65657341, 0.65410155, 0.65162271, 0.64913690,
    0.64664418, 0.64414448, 0.64163786, 0.63912445, 0.63660413,
    0.63407701, 0.63154310, 0.62900239, 0.62645501, 0.62390089,
    0.62134010, 0.61877263, 0.61619854, 0.61361790, 0.61103064,
    0.60843682, 0.60583651, 0.60322970, 0.60061646, 0.59799677,
    0.59537065, 0.59273821, 0.59009939, 0.58745426, 0.58480281,
    0.58214509, 0.57948118, 0.57681108, 0.57413477, 0.57145232,
    0.56876373, 0.56606907, 0.56336832, 0.56066155, 0.55794877,
    0.55523002, 0.55250537, 0.54977477, 0.54703826, 0.54429591,
    0.54154772, 0.53879374, 0.53603399, 0.53326851, 0.53049731,
    0.52772039, 0.52493787, 0.52214974, 0.51935595, 0.51655668,
    0.51375180, 0.51094145, 0.50812566, 0.50530440, 0.50247771,
    0.49964568, 0.49680826, 0.49396557, 0.49111754, 0.48826426,
    0.48540577, 0.48254207, 0.47967321, 0.47679919, 0.47392011,
    0.47103590, 0.46814668, 0.46525243, 0.46235323, 0.45944905,
    0.45653993, 0.45362595, 0.45070711, 0.44778344, 0.44485497,
    0.44192174, 0.43898380, 0.43604112, 0.43309379, 0.43014181,
    0.42718524, 0.42422408, 0.42125839, 0.41828820, 0.41531351,
    0.41233435, 0.40935081, 0.40636289, 0.40337059, 0.40037400,
    0.39737311, 0.39436796, 0.39135858, 0.38834500, 0.38532731,
    0.38230544, 0.37927949, 0.37624949, 0.37321547, 0.37017745,
    0.36713544, 0.36408952, 0.36103970, 0.35798600, 0.35492846,
    0.35186714, 0.34880206, 0.34573323, 0.34266070, 0.33958447,
    0.33650464, 0.33342120, 0.33033419, 0.32724363, 0.32414958,
    0.32105204, 0.31795108, 0.31484672, 0.31173897, 0.30862790,
    0.30551350, 0.30239585, 0.29927495, 0.29615086, 0.29302359,
    0.28989318, 0.28675964, 0.28362307, 0.28048345, 0.27734083,
    0.27419522, 0.27104670, 0.26789525, 0.26474094, 0.26158381,
    0.25842386, 0.25526115, 0.25209570, 0.24892756, 0.24575676,
    0.24258332, 0.23940729, 0.23622867, 0.23304754, 0.22986393,
    0.22667783, 0.22348931, 0.22029841, 0.21710514, 0.21390954,
    0.21071166, 0.20751151, 0.20430915, 0.20110460, 0.19789790,
    0.19468907, 0.19147816, 0.18826519, 0.18505022, 0.18183327,
    0.17861435, 0.17539354, 0.17217083, 0.16894630, 0.16571994,
    0.16249183, 0.15926196, 0.15603039, 0.15279715, 0.14956227,
    0.14632578, 0.14308774, 0.13984816, 0.13660708, 0.13336454,
    0.13012058, 0.12687522, 0.12362850, 0.12038045, 0.11713112,
    0.11388054, 0.11062872, 0.10737573, 0.10412160, 0.10086634,
    0.097609997, 0.094352618, 0.091094226, 0.087834857, 0.084574550,
    0.081313334, 0.078051247, 0.074788325, 0.071524605, 0.068260118,
    0.064994894, 0.061728980, 0.058462404, 0.055195201, 0.051927410,
    0.048659060, 0.045390189, 0.042120833, 0.038851023, 0.035580799,
    0.032310195, 0.029039243, 0.025767982, 0.022496443, 0.019224664,
    0.015952680, 0.012680525, 0.0094082337, 0.0061358409, 0.0028633832,
    -0.00040910527, -0.0036815894, -0.0069540343, -0.010226404, -0.013498665,
    -0.016770782, -0.020042717, -0.023314439, -0.026585912, -0.029857099,
    -0.033127967, -0.036398482, -0.039668605, -0.042938303, -0.046207540,
    -0.049476285, -0.052744497, -0.056012146, -0.059279196, -0.062545612,
    -0.065811358, -0.069076397, -0.072340697, -0.075604223, -0.078866936,
    -0.082128808, -0.085389800, -0.088649876, -0.091909006, -0.095167145,
    -0.098424271, -0.10168034, -0.10493532, -0.10818918, -0.11144188,
    -0.11469338, -0.11794366, -0.12119267, -0.12444039, -0.12768677,
    -0.13093179, -0.13417540, -0.13741758, -0.14065829, -0.14389749,
    -0.14713514, -0.15037122, -0.15360570, -0.15683852, -0.16006967,
    -0.16329910, -0.16652679, -0.16975269, -0.17297678, -0.17619900,
    -0.17941935, -0.18263777, -0.18585424, -0.18906870, -0.19228116,
    -0.19549155, -0.19869985, -0.20190603, -0.20511003, -0.20831184,
    -0.21151142, -0.21470875, -0.21790376, -0.22109644, -0.22428675,
    -0.22747467, -0.23066014, -0.23384315, -0.23702365, -0.24020162,
    -0.24337701, -0.24654980, -0.24971995, -0.25288740, -0.25605217,
    -0.25921419, -0.26237345, -0.26552987, -0.26868346, -0.27183419,
    -0.27498198, -0.27812684, -0.28126872, -0.28440759, -0.28754342,
    -0.29067615, -0.29380578, -0.29693225, -0.30005556, -0.30317566,
    -0.30629250, -0.30940607, -0.31251630, -0.31562322, -0.31872672,
    -0.32182685, -0.32492352, -0.32801670, -0.33110636, -0.33419248,
    -0.33727503, -0.34035397, -0.34342924, -0.34650084, -0.34956875,
    -0.35263291, -0.35569328, -0.35874987, -0.36180258, -0.36485144,
    -0.36789638, -0.37093741, -0.37397444, -0.37700745, -0.38003644,
    -0.38306138, -0.38608220, -0.38909888, -0.39211139, -0.39511973,
    -0.39812380, -0.40112361, -0.40411916, -0.40711036, -0.41009718,
    -0.41307965, -0.41605768, -0.41903123, -0.42200032, -0.42496487,
    -0.42792490, -0.43088034, -0.43383113, -0.43677729, -0.43971881,
    -0.44265559, -0.44558764, -0.44851488, -0.45143735, -0.45435500,
    -0.45726776, -0.46017563, -0.46307856, -0.46597654, -0.46886954,
    -0.47175750, -0.47464043, -0.47751826, -0.48039100, -0.48325855,
    -0.48612097, -0.48897815, -0.49183011, -0.49467680, -0.49751821,
    -0.50035429, -0.50318497, -0.50601029, -0.50883019, -0.51164466,
    -0.51445359, -0.51725709, -0.52005500, -0.52284735, -0.52563411,
    -0.52841520, -0.53119069, -0.53396046, -0.53672451, -0.53948283,
    -0.54223537, -0.54498214, -0.54772300, -0.55045801, -0.55318713,
    -0.55591035, -0.55862761, -0.56133890, -0.56404412, -0.56674337,
    -0.56943649, -0.57212353, -0.57480448, -0.57747924, -0.58014780,
    -0.58281022, -0.58546633, -0.58811617, -0.59075975, -0.59339696,
    -0.59602785, -0.59865236, -0.60127044, -0.60388207, -0.60648727,
    -0.60908598, -0.61167812, -0.61426371, -0.61684275, -0.61941516,
    -0.62198097, -0.62454009, -0.62709254, -0.62963831, -0.63217729,
    -0.63470948, -0.63723493, -0.63975352, -0.64226526, -0.64477009,
    -0.64726806, -0.64975911, -0.65224314, -0.65472025, -0.65719032,
    -0.65965337, -0.66210932, -0.66455823, -0.66700000, -0.66943461,
    -0.67186207, -0.67428231, -0.67669535, -0.67910111, -0.68149966,
    -0.68389088, -0.68627477, -0.68865126, -0.69102043, -0.69338220,
    -0.69573659, -0.69808346, -0.70042288, -0.70275480, -0.70507920,
    -0.70739603, -0.70970529, -0.71200693, -0.71430099, -0.71658736,
    -0.71886611, -0.72113711, -0.72340041, -0.72565591, -0.72790372,
    -0.73014367, -0.73237586, -0.73460019, -0.73681659, -0.73902518,
    -0.74122584, -0.74341851, -0.74560326, -0.74778003, -0.74994880,
    -0.75210953, -0.75426215, -0.75640678, -0.75854325, -0.76067162,
    -0.76279181, -0.76490390, -0.76700771, -0.76910341, -0.77119076,
    -0.77326995, -0.77534080, -0.77740335, -0.77945763, -0.78150350,
    -0.78354102, -0.78557014, -0.78759086, -0.78960317, -0.79160696,
    -0.79360235, -0.79558921, -0.79756755, -0.79953730, -0.80149853,
    -0.80345118, -0.80539525, -0.80733067, -0.80925739, -0.81117553,
    -0.81308490, -0.81498563, -0.81687760, -0.81876087, -0.82063532,
    -0.82250100, -0.82435787, -0.82620591, -0.82804507, -0.82987541,
    -0.83169687, -0.83350939, -0.83531296, -0.83710766, -0.83889335,
    -0.84067005, -0.84243774, -0.84419644, -0.84594607, -0.84768665,
    -0.84941816, -0.85114056, -0.85285389, -0.85455805, -0.85625303,
    -0.85793889, -0.85961550, -0.86128294, -0.86294121, -0.86459017,
    -0.86622989, -0.86786032, -0.86948150, -0.87109333, -0.87269586,
    -0.87428904, -0.87587279, -0.87744725, -0.87901229, -0.88056785,
    -0.88211405, -0.88365078, -0.88517809, -0.88669586, -0.88820416,
    -0.88970292, -0.89119220, -0.89267188, -0.89414203, -0.89560264,
    -0.89705360, -0.89849502, -0.89992678, -0.90134889, -0.90276134,
    -0.90416414, -0.90555727, -0.90694070, -0.90831441, -0.90967834,
    -0.91103262, -0.91237706, -0.91371179, -0.91503674, -0.91635185,
    -0.91765714, -0.91895264, -0.92023826, -0.92151409, -0.92277998,
    -0.92403603, -0.92528218, -0.92651838, -0.92774469, -0.92896110,
    -0.93016750, -0.93136400, -0.93255049, -0.93372697, -0.93489349,
    -0.93604994, -0.93719643, -0.93833286, -0.93945926, -0.94057560,
    -0.94168180, -0.94277799, -0.94386405, -0.94494003, -0.94600588,
    -0.94706154, -0.94810712, -0.94914252, -0.95016778, -0.95118284,
    -0.95218778, -0.95318246, -0.95416695, -0.95514119, -0.95610523,
    -0.95705903, -0.95800257, -0.95893586, -0.95985889, -0.96077162,
    -0.96167403, -0.96256620, -0.96344805, -0.96431959, -0.96518075,
    -0.96603161, -0.96687216, -0.96770233, -0.96852213, -0.96933156,
    -0.97013056, -0.97091925, -0.97169751, -0.97246534, -0.97322279,
    -0.97396982, -0.97470641, -0.97543252, -0.97614825, -0.97685349,
    -0.97754824, -0.97823256, -0.97890645, -0.97956979, -0.98022264,
    -0.98086500, -0.98149687, -0.98211825, -0.98272908, -0.98332942,
    -0.98391914, -0.98449844, -0.98506713, -0.98562527, -0.98617285,
    -0.98670989, -0.98723638, -0.98775226, -0.98825759, -0.98875231,
    -0.98923647, -0.98971003, -0.99017298, -0.99062532, -0.99106705,
    -0.99149817, -0.99191868, -0.99232858, -0.99272782, -0.99311644,
    -0.99349445, -0.99386179, -0.99421853, -0.99456459, -0.99489999,
    -0.99522477, -0.99553883, -0.99584228, -0.99613506, -0.99641716,
    -0.99668860, -0.99694937, -0.99719942, -0.99743885, -0.99766755,
    -0.99788558, -0.99809295, -0.99828959, -0.99847561, -0.99865085,
    -0.99881548, -0.99896932, -0.99911255, -0.99924499, -0.99936682,
    -0.99947786, -0.99957830, -0.99966794, -0.99974692, -0.99981517,
    -0.99987274, -0.99991959, -0.99995571, -0.99998116, -0.99999589,
    0.99999964, 0.99997288, 0.99990326, 0.99979085, 0.99963558,
    0.99943751, 0.99919659, 0.99891287, 0.99858636, 0.99821711,
    0.99780506, 0.99735034, 0.99685282, 0.99631262, 0.99572974,
    0.99510419, 0.99443603, 0.99372530, 0.99297196, 0.99217612,
    0.99133772, 0.99045694, 0.98953366, 0.98856801, 0.98756003,
    0.98650974, 0.98541719, 0.98428243, 0.98310548, 0.98188645,
    0.98062533, 0.97932225, 0.97797716, 0.97659022, 0.97516143,
    0.97369087, 0.97217858, 0.97062469, 0.96902919, 0.96739221,
    0.96571374, 0.96399397, 0.96223283, 0.96043050, 0.95858705,
    0.95670253, 0.95477700, 0.95281059, 0.95080340, 0.94875544,
    0.94666684, 0.94453770, 0.94236809, 0.94015813, 0.93790787,
    0.93561745, 0.93328691, 0.93091643, 0.92850608, 0.92605597,
    0.92356616, 0.92103678, 0.91846794, 0.91585976, 0.91321236,
    0.91052586, 0.90780038, 0.90503591, 0.90223277, 0.89939094,
    0.89651060, 0.89359182, 0.89063478, 0.88763964, 0.88460642,
    0.88153529, 0.87842643, 0.87527996, 0.87209594, 0.86887461,
    0.86561602, 0.86232042, 0.85898781, 0.85561842, 0.85221243,
    0.84876984, 0.84529096, 0.84177583, 0.83822471, 0.83463764,
    0.83101481, 0.82735640, 0.82366252, 0.81993335, 0.81616908,
    0.81236988, 0.80853581, 0.80466717, 0.80076402, 0.79682660,
    0.79285502, 0.78884947, 0.78481019, 0.78073722, 0.77663082,
    0.77249116, 0.76831841, 0.76411277, 0.75987434, 0.75560343,
    0.75130010, 0.74696463, 0.74259710, 0.73819780, 0.73376691,
    0.72930455, 0.72481096, 0.72028631, 0.71573079, 0.71114463,
    0.70652801, 0.70188117, 0.69720417, 0.69249737, 0.68776089,
    0.68299496, 0.67819971, 0.67337549, 0.66852236, 0.66364062,
    0.65873051, 0.65379208, 0.64882571, 0.64383155, 0.63880974,
    0.63376063, 0.62868434, 0.62358117, 0.61845124, 0.61329484,
    0.60811216, 0.60290343, 0.59766883, 0.59240872, 0.58712316,
    0.58181250, 0.57647687, 0.57111657, 0.56573176, 0.56032276,
    0.55488980, 0.54943299, 0.54395270, 0.53844911, 0.53292239,
    0.52737290, 0.52180082, 0.51620632, 0.51058978, 0.50495136,
    0.49929130, 0.49360985, 0.48790723, 0.48218375, 0.47643960,
    0.47067502, 0.46489030, 0.45908567, 0.45326138, 0.44741765,
    0.44155475, 0.43567297, 0.42977250, 0.42385364, 0.41791660,
    0.41196167, 0.40598908, 0.39999911, 0.39399201, 0.38796803,
    0.38192743, 0.37587047, 0.36979741, 0.36370850, 0.35760403,
    0.35148421, 0.34534934, 0.33919969, 0.33303553, 0.32685706,
    0.32066461, 0.31445843, 0.30823877, 0.30200592, 0.29576012,
    0.28950164, 0.28323078, 0.27694780, 0.27065292, 0.26434645,
    0.25802869, 0.25169984, 0.24536023, 0.23901010, 0.23264973,
    0.22627939, 0.21989937, 0.21350993, 0.20711134, 0.20070387,
    0.19428782, 0.18786344, 0.18143101, 0.17499080, 0.16854310,
    0.16208819, 0.15562633, 0.14915779, 0.14268288, 0.13620184,
    0.12971498, 0.12322257, 0.11672486, 0.11022217, 0.10371475,
    0.097202882, 0.090686858, 0.084166944, 0.077643424, 0.071116582,
    0.064586692, 0.058054037, 0.051518895, 0.044981543, 0.038442269,
    0.031901345, 0.025359053, 0.018815678, 0.012271495, 0.0057267868,
    -0.00081816671, -0.0073630852, -0.013907688, -0.020451695, -0.026994826,
    -0.033536803, -0.040077340, -0.046616159, -0.053152986, -0.059687532,
    -0.066219524, -0.072748676, -0.079274714, -0.085797355, -0.092316322,
    -0.098831341, -0.10534211, -0.11184838, -0.11834986, -0.12484626,
    -0.13133731, -0.13782275, -0.14430228, -0.15077563, -0.15724251,
    -0.16370267, -0.17015581, -0.17660165, -0.18303993, -0.18947038,
    -0.19589271, -0.20230664, -0.20871192, -0.21510825, -0.22149536,
    -0.22787298, -0.23424086, -0.24059868, -0.24694622, -0.25328314,
    -0.25960925, -0.26592422, -0.27222782, -0.27851975, -0.28479972,
    -0.29106751, -0.29732284, -0.30356544, -0.30979502, -0.31601134,
    -0.32221413, -0.32840309, -0.33457801, -0.34073856, -0.34688455,
    -0.35301566, -0.35913166, -0.36523229, -0.37131724, -0.37738630,
    -0.38343921, -0.38947567, -0.39549544, -0.40149832, -0.40748394,
    -0.41345215, -0.41940263, -0.42533514, -0.43124944, -0.43714526,
    -0.44302234, -0.44888046, -0.45471936, -0.46053877, -0.46633846,
    -0.47211814, -0.47787762, -0.48361665, -0.48933494, -0.49503228,
    -0.50070840, -0.50636309, -0.51199609, -0.51760709, -0.52319598,
    -0.52876246, -0.53430629, -0.53982723, -0.54532504, -0.55079949,
    -0.55625033, -0.56167740, -0.56708032, -0.57245898, -0.57781315,
    -0.58314258, -0.58844697, -0.59372622, -0.59897995, -0.60420811,
    -0.60941035, -0.61458647, -0.61973625, -0.62485951, -0.62995601,
    -0.63502556, -0.64006782, -0.64508271, -0.65007001, -0.65502942,
    -0.65996075, -0.66486382, -0.66973841, -0.67458433, -0.67940134,
    -0.68418926, -0.68894786, -0.69367695, -0.69837630, -0.70304573,
    -0.70768511, -0.71229410, -0.71687263, -0.72142041, -0.72593731,
    -0.73042315, -0.73487765, -0.73930067, -0.74369204, -0.74805158,
    -0.75237900, -0.75667429, -0.76093709, -0.76516730, -0.76936477,
    -0.77352923, -0.77766061, -0.78175867, -0.78582323, -0.78985411,
    -0.79385114, -0.79781419, -0.80174309, -0.80563760, -0.80949765,
    -0.81332302, -0.81711352, -0.82086903, -0.82458937, -0.82827437,
    -0.83192390, -0.83553779, -0.83911592, -0.84265804, -0.84616417,
    -0.84963393, -0.85306740, -0.85646427, -0.85982448, -0.86314780,
    -0.86643422, -0.86968350, -0.87289548, -0.87607014, -0.87920725,
    -0.88230664, -0.88536829, -0.88839203, -0.89137769, -0.89432514,
    -0.89723432, -0.90010506, -0.90293723, -0.90573072, -0.90848541,
    -0.91120118, -0.91387796, -0.91651553, -0.91911387, -0.92167282,
    -0.92419231, -0.92667222, -0.92911243, -0.93151283, -0.93387336,
    -0.93619382, -0.93847424, -0.94071442, -0.94291431, -0.94507378,
    -0.94719279, -0.94927126, -0.95130903, -0.95330608, -0.95526224,
    -0.95717752, -0.95905179, -0.96088499, -0.96267700, -0.96442777,
    -0.96613729, -0.96780539, -0.96943200, -0.97101706, -0.97256058,
    -0.97406244, -0.97552258, -0.97694093, -0.97831738, -0.97965199,
    -0.98094457, -0.98219514, -0.98340368, -0.98457009, -0.98569429,
    -0.98677629, -0.98781598, -0.98881340, -0.98976845, -0.99068111,
    -0.99155134, -0.99237907, -0.99316430, -0.99390697, -0.99460709,
    -0.99526459, -0.99587947, -0.99645168, -0.99698120, -0.99746799,
    -0.99791211, -0.99831343, -0.99867201, -0.99898779, -0.99926084,
    -0.99949104, -0.99967843, -0.99982297, -0.99992472, -0.99998361,
    0.99999869, 0.99989158, 0.99961317, 0.99916345, 0.99854255,
    0.99775058, 0.99678761, 0.99565387, 0.99434954, 0.99287480,
    0.99122995, 0.98941529, 0.98743105, 0.98527765, 0.98295540,
    0.98046476, 0.97780609, 0.97497988, 0.97198665, 0.96882683,
    0.96550101, 0.96200979, 0.95835376, 0.95453346, 0.95054960,
    0.94640291, 0.94209403, 0.93762374, 0.93299282, 0.92820197,
    0.92325211, 0.91814411, 0.91287869, 0.90745693, 0.90187967,
    0.89614785, 0.89026248, 0.88422459, 0.87803519, 0.87169534,
    0.86520612, 0.85856867, 0.85178405, 0.84485358, 0.83777827,
    0.83055943, 0.82319832, 0.81569612, 0.80805415, 0.80027372,
    0.79235619, 0.78430289, 0.77611518, 0.76779449, 0.75934225,
    0.75075996, 0.74204898, 0.73321080, 0.72424710, 0.71515924,
    0.70594883, 0.69661748, 0.68716675, 0.67759830, 0.66791373,
    0.65811473, 0.64820296, 0.63818014, 0.62804794, 0.61780810,
    0.60746247, 0.59701276, 0.58646071, 0.57580817, 0.56505698,
    0.55420899, 0.54326600, 0.53222996, 0.52110273, 0.50988621,
    0.49858227, 0.48719296, 0.47572014, 0.46416581, 0.45253196,
    0.44082057, 0.42903364, 0.41717321, 0.40524128, 0.39323992,
    0.38117120, 0.36903715, 0.35683987, 0.34458145, 0.33226398,
    0.31988961, 0.30746040, 0.29497850, 0.28244606, 0.26986524,
    0.25723818, 0.24456702, 0.23185398, 0.21910121, 0.20631088,
    0.19348522, 0.18062639, 0.16773662, 0.15481812, 0.14187308,
    0.12890373, 0.11591230, 0.10290100, 0.089872077, 0.076827750,
    0.063770257, 0.050701842, 0.037624735, 0.024541186, 0.011453429,
    -0.0016362892, -0.014725727, -0.027812643, -0.040894791, -0.053969935,
    -0.067035832, -0.080090240, -0.093130924, -0.10615565, -0.11916219,
    -0.13214831, -0.14511178, -0.15805040, -0.17096193, -0.18384418,
    -0.19669491, -0.20951195, -0.22229309, -0.23503613, -0.24773891,
    -0.26039925, -0.27301496, -0.28558388, -0.29810387, -0.31057280,
    -0.32298848, -0.33534884, -0.34765175, -0.35989508, -0.37207675,
    -0.38419467, -0.39624676, -0.40823093, -0.42014518, -0.43198743,
    -0.44375566, -0.45544785, -0.46706200, -0.47859612, -0.49004826,
    -0.50141639, -0.51269865, -0.52389306, -0.53499764, -0.54601061,
    -0.55693001, -0.56775403, -0.57848072, -0.58910829, -0.59963489,
    -0.61005878, -0.62037814, -0.63059121, -0.64069623, -0.65069145,
    -0.66057515, -0.67034572, -0.68000144, -0.68954057, -0.69896162,
    -0.70826286, -0.71744281, -0.72649974, -0.73543227, -0.74423873,
    -0.75291771, -0.76146764, -0.76988715, -0.77817470, -0.78632891,
    -0.79434842, -0.80223179, -0.80997771, -0.81758487, -0.82505190,
    -0.83237761, -0.83956063, -0.84659988, -0.85349399, -0.86024189,
    -0.86684239, -0.87329435, -0.87959671, -0.88574833, -0.89174819,
    -0.89759529, -0.90328854, -0.90882701, -0.91420978, -0.91943592,
    -0.92450452, -0.92941469, -0.93416560, -0.93875647, -0.94318646,
    -0.94745487, -0.95156091, -0.95550388, -0.95928317, -0.96289814,
    -0.96634805, -0.96963239, -0.97275060, -0.97570217, -0.97848648,
    -0.98110318, -0.98355180, -0.98583186, -0.98794299, -0.98988485,
    -0.99165714, -0.99325943, -0.99469161, -0.99595332, -0.99704438,
    -0.99796462, -0.99871385, -0.99929196, -0.99969882, -0.99993443,
    0.99999464, 0.99956632, 0.99845290, 0.99665523, 0.99417448,
    0.99101239, 0.98717111, 0.98265326, 0.97746199, 0.97160077,
    0.96507365, 0.95788515, 0.95004016, 0.94154406, 0.93240267,
    0.92262226, 0.91220951, 0.90117162, 0.88951606, 0.87725091,
    0.86438453, 0.85092574, 0.83688372, 0.82226819, 0.80708915,
    0.79135692, 0.77508235, 0.75827658, 0.74095112, 0.72311783,
    0.70478898, 0.68597710, 0.66669506, 0.64695615, 0.62677377,
    0.60616189, 0.58513457, 0.56370622, 0.54189157, 0.51970547,
    0.49716324, 0.47428027, 0.45107225, 0.42755505, 0.40374488,
    0.37965798, 0.35531086, 0.33072025, 0.30590299, 0.28087607,
    0.25565663, 0.23026201, 0.20470956, 0.17901683, 0.15320139,
    0.12728097, 0.10127331, 0.075196236, 0.049067631, 0.022905400,
    -0.0032725304, -0.029448219, -0.055603724, -0.081721120, -0.10778251,
    -0.13377003, -0.15966587, -0.18545228, -0.21111161, -0.23662624,
    -0.26197869, -0.28715160, -0.31212771, -0.33688989, -0.36142120,
    -0.38570482, -0.40972409, -0.43346253, -0.45690393, -0.48003218,
    -0.50283146, -0.52528608, -0.54738069, -0.56910020, -0.59042966,
    -0.61135447, -0.63186026, -0.65193301, -0.67155898, -0.69072473,
    -0.70941705, -0.72762316, -0.74533063, -0.76252723, -0.77920127,
    -0.79534131, -0.81093621, -0.82597536, -0.84044844, -0.85434550,
    -0.86765707, -0.88037395, -0.89248747, -0.90398932, -0.91487163,
    -0.92512697, -0.93474823, -0.94372886, -0.95206273, -0.95974404,
    -0.96676767, -0.97312868, -0.97882277, -0.98384601, -0.98819500,
    -0.99186671, -0.99485862, -0.99716878, -0.99879545, -0.99973762,
];

const BITREV_480: [u16; 480] = [
    0, 96, 192, 288, 384, 32, 128, 224, 320, 416, 64, 160, 256, 352, 448, 8, 104, 200, 296, 392,
    40, 136, 232, 328, 424, 72, 168, 264, 360, 456, 16, 112, 208, 304, 400, 48, 144, 240, 336, 432,
    80, 176, 272, 368, 464, 24, 120, 216, 312, 408, 56, 152, 248, 344, 440, 88, 184, 280, 376, 472,
    4, 100, 196, 292, 388, 36, 132, 228, 324, 420, 68, 164, 260, 356, 452, 12, 108, 204, 300, 396,
    44, 140, 236, 332, 428, 76, 172, 268, 364, 460, 20, 116, 212, 308, 404, 52, 148, 244, 340, 436,
    84, 180, 276, 372, 468, 28, 124, 220, 316, 412, 60, 156, 252, 348, 444, 92, 188, 284, 380, 476,
    1, 97, 193, 289, 385, 33, 129, 225, 321, 417, 65, 161, 257, 353, 449, 9, 105, 201, 297, 393,
    41, 137, 233, 329, 425, 73, 169, 265, 361, 457, 17, 113, 209, 305, 401, 49, 145, 241, 337, 433,
    81, 177, 273, 369, 465, 25, 121, 217, 313, 409, 57, 153, 249, 345, 441, 89, 185, 281, 377, 473,
    5, 101, 197, 293, 389, 37, 133, 229, 325, 421, 69, 165, 261, 357, 453, 13, 109, 205, 301, 397,
    45, 141, 237, 333, 429, 77, 173, 269, 365, 461, 21, 117, 213, 309, 405, 53, 149, 245, 341, 437,
    85, 181, 277, 373, 469, 29, 125, 221, 317, 413, 61, 157, 253, 349, 445, 93, 189, 285, 381, 477,
    2, 98, 194, 290, 386, 34, 130, 226, 322, 418, 66, 162, 258, 354, 450, 10, 106, 202, 298, 394,
    42, 138, 234, 330, 426, 74, 170, 266, 362, 458, 18, 114, 210, 306, 402, 50, 146, 242, 338, 434,
    82, 178, 274, 370, 466, 26, 122, 218, 314, 410, 58, 154, 250, 346, 442, 90, 186, 282, 378, 474,
    6, 102, 198, 294, 390, 38, 134, 230, 326, 422, 70, 166, 262, 358, 454, 14, 110, 206, 302, 398,
    46, 142, 238, 334, 430, 78, 174, 270, 366, 462, 22, 118, 214, 310, 406, 54, 150, 246, 342, 438,
    86, 182, 278, 374, 470, 30, 126, 222, 318, 414, 62, 158, 254, 350, 446, 94, 190, 286, 382, 478,
    3, 99, 195, 291, 387, 35, 131, 227, 323, 419, 67, 163, 259, 355, 451, 11, 107, 203, 299, 395,
    43, 139, 235, 331, 427, 75, 171, 267, 363, 459, 19, 115, 211, 307, 403, 51, 147, 243, 339, 435,
    83, 179, 275, 371, 467, 27, 123, 219, 315, 411, 59, 155, 251, 347, 443, 91, 187, 283, 379, 475,
    7, 103, 199, 295, 391, 39, 135, 231, 327, 423, 71, 167, 263, 359, 455, 15, 111, 207, 303, 399,
    47, 143, 239, 335, 431, 79, 175, 271, 367, 463, 23, 119, 215, 311, 407, 55, 151, 247, 343, 439,
    87, 183, 279, 375, 471, 31, 127, 223, 319, 415, 63, 159, 255, 351, 447, 95, 191, 287, 383, 479,
];

const BITREV_240: [u16; 240] = [
    0, 48, 96, 144, 192, 16, 64, 112, 160, 208, 32, 80, 128, 176, 224, 4, 52, 100, 148, 196, 20,
    68, 116, 164, 212, 36, 84, 132, 180, 228, 8, 56, 104, 152, 200, 24, 72, 120, 168, 216, 40, 88,
    136, 184, 232, 12, 60, 108, 156, 204, 28, 76, 124, 172, 220, 44, 92, 140, 188, 236, 1, 49, 97,
    145, 193, 17, 65, 113, 161, 209, 33, 81, 129, 177, 225, 5, 53, 101, 149, 197, 21, 69, 117, 165,
    213, 37, 85, 133, 181, 229, 9, 57, 105, 153, 201, 25, 73, 121, 169, 217, 41, 89, 137, 185, 233,
    13, 61, 109, 157, 205, 29, 77, 125, 173, 221, 45, 93, 141, 189, 237, 2, 50, 98, 146, 194, 18,
    66, 114, 162, 210, 34, 82, 130, 178, 226, 6, 54, 102, 150, 198, 22, 70, 118, 166, 214, 38, 86,
    134, 182, 230, 10, 58, 106, 154, 202, 26, 74, 122, 170, 218, 42, 90, 138, 186, 234, 14, 62,
    110, 158, 206, 30, 78, 126, 174, 222, 46, 94, 142, 190, 238, 3, 51, 99, 147, 195, 19, 67, 115,
    163, 211, 35, 83, 131, 179, 227, 7, 55, 103, 151, 199, 23, 71, 119, 167, 215, 39, 87, 135, 183,
    231, 11, 59, 107, 155, 203, 27, 75, 123, 171, 219, 43, 91, 139, 187, 235, 15, 63, 111, 159,
    207, 31, 79, 127, 175, 223, 47, 95, 143, 191, 239,
];

const BITREV_120: [u16; 120] = [
    0, 24, 48, 72, 96, 8, 32, 56, 80, 104, 16, 40, 64, 88, 112, 4, 28, 52, 76, 100, 12, 36, 60, 84,
    108, 20, 44, 68, 92, 116, 1, 25, 49, 73, 97, 9, 33, 57, 81, 105, 17, 41, 65, 89, 113, 5, 29,
    53, 77, 101, 13, 37, 61, 85, 109, 21, 45, 69, 93, 117, 2, 26, 50, 74, 98, 10, 34, 58, 82, 106,
    18, 42, 66, 90, 114, 6, 30, 54, 78, 102, 14, 38, 62, 86, 110, 22, 46, 70, 94, 118, 3, 27, 51,
    75, 99, 11, 35, 59, 83, 107, 19, 43, 67, 91, 115, 7, 31, 55, 79, 103, 15, 39, 63, 87, 111, 23,
    47, 71, 95, 119,
];

const BITREV_60: [u16; 60] = [
    0, 12, 24, 36, 48, 4, 16, 28, 40, 52, 8, 20, 32, 44, 56, 1, 13, 25, 37, 49, 5, 17, 29, 41, 53,
    9, 21, 33, 45, 57, 2, 14, 26, 38, 50, 6, 18, 30, 42, 54, 10, 22, 34, 46, 58, 3, 15, 27, 39, 51,
    7, 19, 31, 43, 55, 11, 23, 35, 47, 59,
];

#[rustfmt::skip]
#[allow(clippy::approx_constant)]
#[allow(clippy::excessive_precision)]
const TWIDDLES_480000_960: [Twiddle; 480] = [
    Twiddle { r: 1.0000000, i: -0.0000000 }, Twiddle { r: 0.99991433, i: -0.013089596 },
    Twiddle { r: 0.99965732, i: -0.026176948 }, Twiddle { r: 0.99922904, i: -0.039259816 },
    Twiddle { r: 0.99862953, i: -0.052335956 }, Twiddle { r: 0.99785892, i: -0.065403129 },
    Twiddle { r: 0.99691733, i: -0.078459096 }, Twiddle { r: 0.99580493, i: -0.091501619 },
    Twiddle { r: 0.99452190, i: -0.10452846 }, Twiddle { r: 0.99306846, i: -0.11753740 },
    Twiddle { r: 0.99144486, i: -0.13052619 }, Twiddle { r: 0.98965139, i: -0.14349262 },
    Twiddle { r: 0.98768834, i: -0.15643447 }, Twiddle { r: 0.98555606, i: -0.16934950 },
    Twiddle { r: 0.98325491, i: -0.18223553 }, Twiddle { r: 0.98078528, i: -0.19509032 },
    Twiddle { r: 0.97814760, i: -0.20791169 }, Twiddle { r: 0.97534232, i: -0.22069744 },
    Twiddle { r: 0.97236992, i: -0.23344536 }, Twiddle { r: 0.96923091, i: -0.24615329 },
    Twiddle { r: 0.96592583, i: -0.25881905 }, Twiddle { r: 0.96245524, i: -0.27144045 },
    Twiddle { r: 0.95881973, i: -0.28401534 }, Twiddle { r: 0.95501994, i: -0.29654157 },
    Twiddle { r: 0.95105652, i: -0.30901699 }, Twiddle { r: 0.94693013, i: -0.32143947 },
    Twiddle { r: 0.94264149, i: -0.33380686 }, Twiddle { r: 0.93819134, i: -0.34611706 },
    Twiddle { r: 0.93358043, i: -0.35836795 }, Twiddle { r: 0.92880955, i: -0.37055744 },
    Twiddle { r: 0.92387953, i: -0.38268343 }, Twiddle { r: 0.91879121, i: -0.39474386 },
    Twiddle { r: 0.91354546, i: -0.40673664 }, Twiddle { r: 0.90814317, i: -0.41865974 },
    Twiddle { r: 0.90258528, i: -0.43051110 }, Twiddle { r: 0.89687274, i: -0.44228869 },
    Twiddle { r: 0.89100652, i: -0.45399050 }, Twiddle { r: 0.88498764, i: -0.46561452 },
    Twiddle { r: 0.87881711, i: -0.47715876 }, Twiddle { r: 0.87249601, i: -0.48862124 },
    Twiddle { r: 0.86602540, i: -0.50000000 }, Twiddle { r: 0.85940641, i: -0.51129309 },
    Twiddle { r: 0.85264016, i: -0.52249856 }, Twiddle { r: 0.84572782, i: -0.53361452 },
    Twiddle { r: 0.83867057, i: -0.54463904 }, Twiddle { r: 0.83146961, i: -0.55557023 },
    Twiddle { r: 0.82412619, i: -0.56640624 }, Twiddle { r: 0.81664156, i: -0.57714519 },
    Twiddle { r: 0.80901699, i: -0.58778525 }, Twiddle { r: 0.80125381, i: -0.59832460 },
    Twiddle { r: 0.79335334, i: -0.60876143 }, Twiddle { r: 0.78531693, i: -0.61909395 },
    Twiddle { r: 0.77714596, i: -0.62932039 }, Twiddle { r: 0.76884183, i: -0.63943900 },
    Twiddle { r: 0.76040597, i: -0.64944805 }, Twiddle { r: 0.75183981, i: -0.65934582 },
    Twiddle { r: 0.74314483, i: -0.66913061 }, Twiddle { r: 0.73432251, i: -0.67880075 },
    Twiddle { r: 0.72537437, i: -0.68835458 }, Twiddle { r: 0.71630194, i: -0.69779046 },
    Twiddle { r: 0.70710678, i: -0.70710678 }, Twiddle { r: 0.69779046, i: -0.71630194 },
    Twiddle { r: 0.68835458, i: -0.72537437 }, Twiddle { r: 0.67880075, i: -0.73432251 },
    Twiddle { r: 0.66913061, i: -0.74314483 }, Twiddle { r: 0.65934582, i: -0.75183981 },
    Twiddle { r: 0.64944805, i: -0.76040597 }, Twiddle { r: 0.63943900, i: -0.76884183 },
    Twiddle { r: 0.62932039, i: -0.77714596 }, Twiddle { r: 0.61909395, i: -0.78531693 },
    Twiddle { r: 0.60876143, i: -0.79335334 }, Twiddle { r: 0.59832460, i: -0.80125381 },
    Twiddle { r: 0.58778525, i: -0.80901699 }, Twiddle { r: 0.57714519, i: -0.81664156 },
    Twiddle { r: 0.56640624, i: -0.82412619 }, Twiddle { r: 0.55557023, i: -0.83146961 },
    Twiddle { r: 0.54463904, i: -0.83867057 }, Twiddle { r: 0.53361452, i: -0.84572782 },
    Twiddle { r: 0.52249856, i: -0.85264016 }, Twiddle { r: 0.51129309, i: -0.85940641 },
    Twiddle { r: 0.50000000, i: -0.86602540 }, Twiddle { r: 0.48862124, i: -0.87249601 },
    Twiddle { r: 0.47715876, i: -0.87881711 }, Twiddle { r: 0.46561452, i: -0.88498764 },
    Twiddle { r: 0.45399050, i: -0.89100652 }, Twiddle { r: 0.44228869, i: -0.89687274 },
    Twiddle { r: 0.43051110, i: -0.90258528 }, Twiddle { r: 0.41865974, i: -0.90814317 },
    Twiddle { r: 0.40673664, i: -0.91354546 }, Twiddle { r: 0.39474386, i: -0.91879121 },
    Twiddle { r: 0.38268343, i: -0.92387953 }, Twiddle { r: 0.37055744, i: -0.92880955 },
    Twiddle { r: 0.35836795, i: -0.93358043 }, Twiddle { r: 0.34611706, i: -0.93819134 },
    Twiddle { r: 0.33380686, i: -0.94264149 }, Twiddle { r: 0.32143947, i: -0.94693013 },
    Twiddle { r: 0.30901699, i: -0.95105652 }, Twiddle { r: 0.29654157, i: -0.95501994 },
    Twiddle { r: 0.28401534, i: -0.95881973 }, Twiddle { r: 0.27144045, i: -0.96245524 },
    Twiddle { r: 0.25881905, i: -0.96592583 }, Twiddle { r: 0.24615329, i: -0.96923091 },
    Twiddle { r: 0.23344536, i: -0.97236992 }, Twiddle { r: 0.22069744, i: -0.97534232 },
    Twiddle { r: 0.20791169, i: -0.97814760 }, Twiddle { r: 0.19509032, i: -0.98078528 },
    Twiddle { r: 0.18223553, i: -0.98325491 }, Twiddle { r: 0.16934950, i: -0.98555606 },
    Twiddle { r: 0.15643447, i: -0.98768834 }, Twiddle { r: 0.14349262, i: -0.98965139 },
    Twiddle { r: 0.13052619, i: -0.99144486 }, Twiddle { r: 0.11753740, i: -0.99306846 },
    Twiddle { r: 0.10452846, i: -0.99452190 }, Twiddle { r: 0.091501619, i: -0.99580493 },
    Twiddle { r: 0.078459096, i: -0.99691733 }, Twiddle { r: 0.065403129, i: -0.99785892 },
    Twiddle { r: 0.052335956, i: -0.99862953 }, Twiddle { r: 0.039259816, i: -0.99922904 },
    Twiddle { r: 0.026176948, i: -0.99965732 }, Twiddle { r: 0.013089596, i: -0.99991433 },
    Twiddle { r: 6.1230318e-17, i: -1.0000000 }, Twiddle { r: -0.013089596, i: -0.99991433 },
    Twiddle { r: -0.026176948, i: -0.99965732 }, Twiddle { r: -0.039259816, i: -0.99922904 },
    Twiddle { r: -0.052335956, i: -0.99862953 }, Twiddle { r: -0.065403129, i: -0.99785892 },
    Twiddle { r: -0.078459096, i: -0.99691733 }, Twiddle { r: -0.091501619, i: -0.99580493 },
    Twiddle { r: -0.10452846, i: -0.99452190 }, Twiddle { r: -0.11753740, i: -0.99306846 },
    Twiddle { r: -0.13052619, i: -0.99144486 }, Twiddle { r: -0.14349262, i: -0.98965139 },
    Twiddle { r: -0.15643447, i: -0.98768834 }, Twiddle { r: -0.16934950, i: -0.98555606 },
    Twiddle { r: -0.18223553, i: -0.98325491 }, Twiddle { r: -0.19509032, i: -0.98078528 },
    Twiddle { r: -0.20791169, i: -0.97814760 }, Twiddle { r: -0.22069744, i: -0.97534232 },
    Twiddle { r: -0.23344536, i: -0.97236992 }, Twiddle { r: -0.24615329, i: -0.96923091 },
    Twiddle { r: -0.25881905, i: -0.96592583 }, Twiddle { r: -0.27144045, i: -0.96245524 },
    Twiddle { r: -0.28401534, i: -0.95881973 }, Twiddle { r: -0.29654157, i: -0.95501994 },
    Twiddle { r: -0.30901699, i: -0.95105652 }, Twiddle { r: -0.32143947, i: -0.94693013 },
    Twiddle { r: -0.33380686, i: -0.94264149 }, Twiddle { r: -0.34611706, i: -0.93819134 },
    Twiddle { r: -0.35836795, i: -0.93358043 }, Twiddle { r: -0.37055744, i: -0.92880955 },
    Twiddle { r: -0.38268343, i: -0.92387953 }, Twiddle { r: -0.39474386, i: -0.91879121 },
    Twiddle { r: -0.40673664, i: -0.91354546 }, Twiddle { r: -0.41865974, i: -0.90814317 },
    Twiddle { r: -0.43051110, i: -0.90258528 }, Twiddle { r: -0.44228869, i: -0.89687274 },
    Twiddle { r: -0.45399050, i: -0.89100652 }, Twiddle { r: -0.46561452, i: -0.88498764 },
    Twiddle { r: -0.47715876, i: -0.87881711 }, Twiddle { r: -0.48862124, i: -0.87249601 },
    Twiddle { r: -0.50000000, i: -0.86602540 }, Twiddle { r: -0.51129309, i: -0.85940641 },
    Twiddle { r: -0.52249856, i: -0.85264016 }, Twiddle { r: -0.53361452, i: -0.84572782 },
    Twiddle { r: -0.54463904, i: -0.83867057 }, Twiddle { r: -0.55557023, i: -0.83146961 },
    Twiddle { r: -0.56640624, i: -0.82412619 }, Twiddle { r: -0.57714519, i: -0.81664156 },
    Twiddle { r: -0.58778525, i: -0.80901699 }, Twiddle { r: -0.59832460, i: -0.80125381 },
    Twiddle { r: -0.60876143, i: -0.79335334 }, Twiddle { r: -0.61909395, i: -0.78531693 },
    Twiddle { r: -0.62932039, i: -0.77714596 }, Twiddle { r: -0.63943900, i: -0.76884183 },
    Twiddle { r: -0.64944805, i: -0.76040597 }, Twiddle { r: -0.65934582, i: -0.75183981 },
    Twiddle { r: -0.66913061, i: -0.74314483 }, Twiddle { r: -0.67880075, i: -0.73432251 },
    Twiddle { r: -0.68835458, i: -0.72537437 }, Twiddle { r: -0.69779046, i: -0.71630194 },
    Twiddle { r: -0.70710678, i: -0.70710678 }, Twiddle { r: -0.71630194, i: -0.69779046 },
    Twiddle { r: -0.72537437, i: -0.68835458 }, Twiddle { r: -0.73432251, i: -0.67880075 },
    Twiddle { r: -0.74314483, i: -0.66913061 }, Twiddle { r: -0.75183981, i: -0.65934582 },
    Twiddle { r: -0.76040597, i: -0.64944805 }, Twiddle { r: -0.76884183, i: -0.63943900 },
    Twiddle { r: -0.77714596, i: -0.62932039 }, Twiddle { r: -0.78531693, i: -0.61909395 },
    Twiddle { r: -0.79335334, i: -0.60876143 }, Twiddle { r: -0.80125381, i: -0.59832460 },
    Twiddle { r: -0.80901699, i: -0.58778525 }, Twiddle { r: -0.81664156, i: -0.57714519 },
    Twiddle { r: -0.82412619, i: -0.56640624 }, Twiddle { r: -0.83146961, i: -0.55557023 },
    Twiddle { r: -0.83867057, i: -0.54463904 }, Twiddle { r: -0.84572782, i: -0.53361452 },
    Twiddle { r: -0.85264016, i: -0.52249856 }, Twiddle { r: -0.85940641, i: -0.51129309 },
    Twiddle { r: -0.86602540, i: -0.50000000 }, Twiddle { r: -0.87249601, i: -0.48862124 },
    Twiddle { r: -0.87881711, i: -0.47715876 }, Twiddle { r: -0.88498764, i: -0.46561452 },
    Twiddle { r: -0.89100652, i: -0.45399050 }, Twiddle { r: -0.89687274, i: -0.44228869 },
    Twiddle { r: -0.90258528, i: -0.43051110 }, Twiddle { r: -0.90814317, i: -0.41865974 },
    Twiddle { r: -0.91354546, i: -0.40673664 }, Twiddle { r: -0.91879121, i: -0.39474386 },
    Twiddle { r: -0.92387953, i: -0.38268343 }, Twiddle { r: -0.92880955, i: -0.37055744 },
    Twiddle { r: -0.93358043, i: -0.35836795 }, Twiddle { r: -0.93819134, i: -0.34611706 },
    Twiddle { r: -0.94264149, i: -0.33380686 }, Twiddle { r: -0.94693013, i: -0.32143947 },
    Twiddle { r: -0.95105652, i: -0.30901699 }, Twiddle { r: -0.95501994, i: -0.29654157 },
    Twiddle { r: -0.95881973, i: -0.28401534 }, Twiddle { r: -0.96245524, i: -0.27144045 },
    Twiddle { r: -0.96592583, i: -0.25881905 }, Twiddle { r: -0.96923091, i: -0.24615329 },
    Twiddle { r: -0.97236992, i: -0.23344536 }, Twiddle { r: -0.97534232, i: -0.22069744 },
    Twiddle { r: -0.97814760, i: -0.20791169 }, Twiddle { r: -0.98078528, i: -0.19509032 },
    Twiddle { r: -0.98325491, i: -0.18223553 }, Twiddle { r: -0.98555606, i: -0.16934950 },
    Twiddle { r: -0.98768834, i: -0.15643447 }, Twiddle { r: -0.98965139, i: -0.14349262 },
    Twiddle { r: -0.99144486, i: -0.13052619 }, Twiddle { r: -0.99306846, i: -0.11753740 },
    Twiddle { r: -0.99452190, i: -0.10452846 }, Twiddle { r: -0.99580493, i: -0.091501619 },
    Twiddle { r: -0.99691733, i: -0.078459096 }, Twiddle { r: -0.99785892, i: -0.065403129 },
    Twiddle { r: -0.99862953, i: -0.052335956 }, Twiddle { r: -0.99922904, i: -0.039259816 },
    Twiddle { r: -0.99965732, i: -0.026176948 }, Twiddle { r: -0.99991433, i: -0.013089596 },
    Twiddle { r: -1.0000000, i: -1.2246064e-16 }, Twiddle { r: -0.99991433, i: 0.013089596 },
    Twiddle { r: -0.99965732, i: 0.026176948 }, Twiddle { r: -0.99922904, i: 0.039259816 },
    Twiddle { r: -0.99862953, i: 0.052335956 }, Twiddle { r: -0.99785892, i: 0.065403129 },
    Twiddle { r: -0.99691733, i: 0.078459096 }, Twiddle { r: -0.99580493, i: 0.091501619 },
    Twiddle { r: -0.99452190, i: 0.10452846 }, Twiddle { r: -0.99306846, i: 0.11753740 },
    Twiddle { r: -0.99144486, i: 0.13052619 }, Twiddle { r: -0.98965139, i: 0.14349262 },
    Twiddle { r: -0.98768834, i: 0.15643447 }, Twiddle { r: -0.98555606, i: 0.16934950 },
    Twiddle { r: -0.98325491, i: 0.18223553 }, Twiddle { r: -0.98078528, i: 0.19509032 },
    Twiddle { r: -0.97814760, i: 0.20791169 }, Twiddle { r: -0.97534232, i: 0.22069744 },
    Twiddle { r: -0.97236992, i: 0.23344536 }, Twiddle { r: -0.96923091, i: 0.24615329 },
    Twiddle { r: -0.96592583, i: 0.25881905 }, Twiddle { r: -0.96245524, i: 0.27144045 },
    Twiddle { r: -0.95881973, i: 0.28401534 }, Twiddle { r: -0.95501994, i: 0.29654157 },
    Twiddle { r: -0.95105652, i: 0.30901699 }, Twiddle { r: -0.94693013, i: 0.32143947 },
    Twiddle { r: -0.94264149, i: 0.33380686 }, Twiddle { r: -0.93819134, i: 0.34611706 },
    Twiddle { r: -0.93358043, i: 0.35836795 }, Twiddle { r: -0.92880955, i: 0.37055744 },
    Twiddle { r: -0.92387953, i: 0.38268343 }, Twiddle { r: -0.91879121, i: 0.39474386 },
    Twiddle { r: -0.91354546, i: 0.40673664 }, Twiddle { r: -0.90814317, i: 0.41865974 },
    Twiddle { r: -0.90258528, i: 0.43051110 }, Twiddle { r: -0.89687274, i: 0.44228869 },
    Twiddle { r: -0.89100652, i: 0.45399050 }, Twiddle { r: -0.88498764, i: 0.46561452 },
    Twiddle { r: -0.87881711, i: 0.47715876 }, Twiddle { r: -0.87249601, i: 0.48862124 },
    Twiddle { r: -0.86602540, i: 0.50000000 }, Twiddle { r: -0.85940641, i: 0.51129309 },
    Twiddle { r: -0.85264016, i: 0.52249856 }, Twiddle { r: -0.84572782, i: 0.53361452 },
    Twiddle { r: -0.83867057, i: 0.54463904 }, Twiddle { r: -0.83146961, i: 0.55557023 },
    Twiddle { r: -0.82412619, i: 0.56640624 }, Twiddle { r: -0.81664156, i: 0.57714519 },
    Twiddle { r: -0.80901699, i: 0.58778525 }, Twiddle { r: -0.80125381, i: 0.59832460 },
    Twiddle { r: -0.79335334, i: 0.60876143 }, Twiddle { r: -0.78531693, i: 0.61909395 },
    Twiddle { r: -0.77714596, i: 0.62932039 }, Twiddle { r: -0.76884183, i: 0.63943900 },
    Twiddle { r: -0.76040597, i: 0.64944805 }, Twiddle { r: -0.75183981, i: 0.65934582 },
    Twiddle { r: -0.74314483, i: 0.66913061 }, Twiddle { r: -0.73432251, i: 0.67880075 },
    Twiddle { r: -0.72537437, i: 0.68835458 }, Twiddle { r: -0.71630194, i: 0.69779046 },
    Twiddle { r: -0.70710678, i: 0.70710678 }, Twiddle { r: -0.69779046, i: 0.71630194 },
    Twiddle { r: -0.68835458, i: 0.72537437 }, Twiddle { r: -0.67880075, i: 0.73432251 },
    Twiddle { r: -0.66913061, i: 0.74314483 }, Twiddle { r: -0.65934582, i: 0.75183981 },
    Twiddle { r: -0.64944805, i: 0.76040597 }, Twiddle { r: -0.63943900, i: 0.76884183 },
    Twiddle { r: -0.62932039, i: 0.77714596 }, Twiddle { r: -0.61909395, i: 0.78531693 },
    Twiddle { r: -0.60876143, i: 0.79335334 }, Twiddle { r: -0.59832460, i: 0.80125381 },
    Twiddle { r: -0.58778525, i: 0.80901699 }, Twiddle { r: -0.57714519, i: 0.81664156 },
    Twiddle { r: -0.56640624, i: 0.82412619 }, Twiddle { r: -0.55557023, i: 0.83146961 },
    Twiddle { r: -0.54463904, i: 0.83867057 }, Twiddle { r: -0.53361452, i: 0.84572782 },
    Twiddle { r: -0.52249856, i: 0.85264016 }, Twiddle { r: -0.51129309, i: 0.85940641 },
    Twiddle { r: -0.50000000, i: 0.86602540 }, Twiddle { r: -0.48862124, i: 0.87249601 },
    Twiddle { r: -0.47715876, i: 0.87881711 }, Twiddle { r: -0.46561452, i: 0.88498764 },
    Twiddle { r: -0.45399050, i: 0.89100652 }, Twiddle { r: -0.44228869, i: 0.89687274 },
    Twiddle { r: -0.43051110, i: 0.90258528 }, Twiddle { r: -0.41865974, i: 0.90814317 },
    Twiddle { r: -0.40673664, i: 0.91354546 }, Twiddle { r: -0.39474386, i: 0.91879121 },
    Twiddle { r: -0.38268343, i: 0.92387953 }, Twiddle { r: -0.37055744, i: 0.92880955 },
    Twiddle { r: -0.35836795, i: 0.93358043 }, Twiddle { r: -0.34611706, i: 0.93819134 },
    Twiddle { r: -0.33380686, i: 0.94264149 }, Twiddle { r: -0.32143947, i: 0.94693013 },
    Twiddle { r: -0.30901699, i: 0.95105652 }, Twiddle { r: -0.29654157, i: 0.95501994 },
    Twiddle { r: -0.28401534, i: 0.95881973 }, Twiddle { r: -0.27144045, i: 0.96245524 },
    Twiddle { r: -0.25881905, i: 0.96592583 }, Twiddle { r: -0.24615329, i: 0.96923091 },
    Twiddle { r: -0.23344536, i: 0.97236992 }, Twiddle { r: -0.22069744, i: 0.97534232 },
    Twiddle { r: -0.20791169, i: 0.97814760 }, Twiddle { r: -0.19509032, i: 0.98078528 },
    Twiddle { r: -0.18223553, i: 0.98325491 }, Twiddle { r: -0.16934950, i: 0.98555606 },
    Twiddle { r: -0.15643447, i: 0.98768834 }, Twiddle { r: -0.14349262, i: 0.98965139 },
    Twiddle { r: -0.13052619, i: 0.99144486 }, Twiddle { r: -0.11753740, i: 0.99306846 },
    Twiddle { r: -0.10452846, i: 0.99452190 }, Twiddle { r: -0.091501619, i: 0.99580493 },
    Twiddle { r: -0.078459096, i: 0.99691733 }, Twiddle { r: -0.065403129, i: 0.99785892 },
    Twiddle { r: -0.052335956, i: 0.99862953 }, Twiddle { r: -0.039259816, i: 0.99922904 },
    Twiddle { r: -0.026176948, i: 0.99965732 }, Twiddle { r: -0.013089596, i: 0.99991433 },
    Twiddle { r: -1.8369095e-16, i: 1.0000000 }, Twiddle { r: 0.013089596, i: 0.99991433 },
    Twiddle { r: 0.026176948, i: 0.99965732 }, Twiddle { r: 0.039259816, i: 0.99922904 },
    Twiddle { r: 0.052335956, i: 0.99862953 }, Twiddle { r: 0.065403129, i: 0.99785892 },
    Twiddle { r: 0.078459096, i: 0.99691733 }, Twiddle { r: 0.091501619, i: 0.99580493 },
    Twiddle { r: 0.10452846, i: 0.99452190 }, Twiddle { r: 0.11753740, i: 0.99306846 },
    Twiddle { r: 0.13052619, i: 0.99144486 }, Twiddle { r: 0.14349262, i: 0.98965139 },
    Twiddle { r: 0.15643447, i: 0.98768834 }, Twiddle { r: 0.16934950, i: 0.98555606 },
    Twiddle { r: 0.18223553, i: 0.98325491 }, Twiddle { r: 0.19509032, i: 0.98078528 },
    Twiddle { r: 0.20791169, i: 0.97814760 }, Twiddle { r: 0.22069744, i: 0.97534232 },
    Twiddle { r: 0.23344536, i: 0.97236992 }, Twiddle { r: 0.24615329, i: 0.96923091 },
    Twiddle { r: 0.25881905, i: 0.96592583 }, Twiddle { r: 0.27144045, i: 0.96245524 },
    Twiddle { r: 0.28401534, i: 0.95881973 }, Twiddle { r: 0.29654157, i: 0.95501994 },
    Twiddle { r: 0.30901699, i: 0.95105652 }, Twiddle { r: 0.32143947, i: 0.94693013 },
    Twiddle { r: 0.33380686, i: 0.94264149 }, Twiddle { r: 0.34611706, i: 0.93819134 },
    Twiddle { r: 0.35836795, i: 0.93358043 }, Twiddle { r: 0.37055744, i: 0.92880955 },
    Twiddle { r: 0.38268343, i: 0.92387953 }, Twiddle { r: 0.39474386, i: 0.91879121 },
    Twiddle { r: 0.40673664, i: 0.91354546 }, Twiddle { r: 0.41865974, i: 0.90814317 },
    Twiddle { r: 0.43051110, i: 0.90258528 }, Twiddle { r: 0.44228869, i: 0.89687274 },
    Twiddle { r: 0.45399050, i: 0.89100652 }, Twiddle { r: 0.46561452, i: 0.88498764 },
    Twiddle { r: 0.47715876, i: 0.87881711 }, Twiddle { r: 0.48862124, i: 0.87249601 },
    Twiddle { r: 0.50000000, i: 0.86602540 }, Twiddle { r: 0.51129309, i: 0.85940641 },
    Twiddle { r: 0.52249856, i: 0.85264016 }, Twiddle { r: 0.53361452, i: 0.84572782 },
    Twiddle { r: 0.54463904, i: 0.83867057 }, Twiddle { r: 0.55557023, i: 0.83146961 },
    Twiddle { r: 0.56640624, i: 0.82412619 }, Twiddle { r: 0.57714519, i: 0.81664156 },
    Twiddle { r: 0.58778525, i: 0.80901699 }, Twiddle { r: 0.59832460, i: 0.80125381 },
    Twiddle { r: 0.60876143, i: 0.79335334 }, Twiddle { r: 0.61909395, i: 0.78531693 },
    Twiddle { r: 0.62932039, i: 0.77714596 }, Twiddle { r: 0.63943900, i: 0.76884183 },
    Twiddle { r: 0.64944805, i: 0.76040597 }, Twiddle { r: 0.65934582, i: 0.75183981 },
    Twiddle { r: 0.66913061, i: 0.74314483 }, Twiddle { r: 0.67880075, i: 0.73432251 },
    Twiddle { r: 0.68835458, i: 0.72537437 }, Twiddle { r: 0.69779046, i: 0.71630194 },
    Twiddle { r: 0.70710678, i: 0.70710678 }, Twiddle { r: 0.71630194, i: 0.69779046 },
    Twiddle { r: 0.72537437, i: 0.68835458 }, Twiddle { r: 0.73432251, i: 0.67880075 },
    Twiddle { r: 0.74314483, i: 0.66913061 }, Twiddle { r: 0.75183981, i: 0.65934582 },
    Twiddle { r: 0.76040597, i: 0.64944805 }, Twiddle { r: 0.76884183, i: 0.63943900 },
    Twiddle { r: 0.77714596, i: 0.62932039 }, Twiddle { r: 0.78531693, i: 0.61909395 },
    Twiddle { r: 0.79335334, i: 0.60876143 }, Twiddle { r: 0.80125381, i: 0.59832460 },
    Twiddle { r: 0.80901699, i: 0.58778525 }, Twiddle { r: 0.81664156, i: 0.57714519 },
    Twiddle { r: 0.82412619, i: 0.56640624 }, Twiddle { r: 0.83146961, i: 0.55557023 },
    Twiddle { r: 0.83867057, i: 0.54463904 }, Twiddle { r: 0.84572782, i: 0.53361452 },
    Twiddle { r: 0.85264016, i: 0.52249856 }, Twiddle { r: 0.85940641, i: 0.51129309 },
    Twiddle { r: 0.86602540, i: 0.50000000 }, Twiddle { r: 0.87249601, i: 0.48862124 },
    Twiddle { r: 0.87881711, i: 0.47715876 }, Twiddle { r: 0.88498764, i: 0.46561452 },
    Twiddle { r: 0.89100652, i: 0.45399050 }, Twiddle { r: 0.89687274, i: 0.44228869 },
    Twiddle { r: 0.90258528, i: 0.43051110 }, Twiddle { r: 0.90814317, i: 0.41865974 },
    Twiddle { r: 0.91354546, i: 0.40673664 }, Twiddle { r: 0.91879121, i: 0.39474386 },
    Twiddle { r: 0.92387953, i: 0.38268343 }, Twiddle { r: 0.92880955, i: 0.37055744 },
    Twiddle { r: 0.93358043, i: 0.35836795 }, Twiddle { r: 0.93819134, i: 0.34611706 },
    Twiddle { r: 0.94264149, i: 0.33380686 }, Twiddle { r: 0.94693013, i: 0.32143947 },
    Twiddle { r: 0.95105652, i: 0.30901699 }, Twiddle { r: 0.95501994, i: 0.29654157 },
    Twiddle { r: 0.95881973, i: 0.28401534 }, Twiddle { r: 0.96245524, i: 0.27144045 },
    Twiddle { r: 0.96592583, i: 0.25881905 }, Twiddle { r: 0.96923091, i: 0.24615329 },
    Twiddle { r: 0.97236992, i: 0.23344536 }, Twiddle { r: 0.97534232, i: 0.22069744 },
    Twiddle { r: 0.97814760, i: 0.20791169 }, Twiddle { r: 0.98078528, i: 0.19509032 },
    Twiddle { r: 0.98325491, i: 0.18223553 }, Twiddle { r: 0.98555606, i: 0.16934950 },
    Twiddle { r: 0.98768834, i: 0.15643447 }, Twiddle { r: 0.98965139, i: 0.14349262 },
    Twiddle { r: 0.99144486, i: 0.13052619 }, Twiddle { r: 0.99306846, i: 0.11753740 },
    Twiddle { r: 0.99452190, i: 0.10452846 }, Twiddle { r: 0.99580493, i: 0.091501619 },
    Twiddle { r: 0.99691733, i: 0.078459096 }, Twiddle { r: 0.99785892, i: 0.065403129 },
    Twiddle { r: 0.99862953, i: 0.052335956 }, Twiddle { r: 0.99922904, i: 0.039259816 },
    Twiddle { r: 0.99965732, i: 0.026176948 }, Twiddle { r: 0.99991433, i: 0.013089596 },
];

const KFFT: [KissFft; 4] = [
    KissFft {
        nfft: 480,
        scale: 0.002083333,
        shift: 0,
        factors: [5, 96, 3, 32, 4, 8, 2, 4, 4, 1, 0, 0, 0, 0, 0, 0],
        bitrev: &BITREV_480,
        twiddles: &TWIDDLES_480000_960,
    },
    KissFft {
        nfft: 240,
        scale: 0.004166667,
        shift: 1,
        factors: [5, 48, 3, 16, 4, 4, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0],
        bitrev: &BITREV_240,
        twiddles: &TWIDDLES_480000_960,
    },
    KissFft {
        nfft: 120,
        scale: 0.008333333,
        shift: 2,
        factors: [5, 24, 3, 8, 2, 4, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0],
        bitrev: &BITREV_120,
        twiddles: &TWIDDLES_480000_960,
    },
    KissFft {
        nfft: 60,
        scale: 0.016666667,
        shift: 3,
        factors: [5, 12, 3, 4, 4, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        bitrev: &BITREV_60,
        twiddles: &TWIDDLES_480000_960,
    },
];

const CACHE_INDEX: [i16; 105] = [
    -1, -1, -1, -1, -1, -1, -1, -1, 0, 0, 0, 0, 41, 41, 41, 82, 82, 123, 164, 200, 222, 0, 0, 0, 0,
    0, 0, 0, 0, 41, 41, 41, 41, 123, 123, 123, 164, 164, 240, 266, 283, 295, 41, 41, 41, 41, 41,
    41, 41, 41, 123, 123, 123, 123, 240, 240, 240, 266, 266, 305, 318, 328, 336, 123, 123, 123,
    123, 123, 123, 123, 123, 240, 240, 240, 240, 305, 305, 305, 318, 318, 343, 351, 358, 364, 240,
    240, 240, 240, 240, 240, 240, 240, 305, 305, 305, 305, 343, 343, 343, 351, 351, 370, 376, 382,
    387,
];

const CACHE_BITS: [u8; 392] = [
    40, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7,
    7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 40, 15, 23, 28, 31, 34, 36, 38, 39, 41, 42, 43, 44, 45, 46, 47,
    47, 49, 50, 51, 52, 53, 54, 55, 55, 57, 58, 59, 60, 61, 62, 63, 63, 65, 66, 67, 68, 69, 70, 71,
    71, 40, 20, 33, 41, 48, 53, 57, 61, 64, 66, 69, 71, 73, 75, 76, 78, 80, 82, 85, 87, 89, 91, 92,
    94, 96, 98, 101, 103, 105, 107, 108, 110, 112, 114, 117, 119, 121, 123, 124, 126, 128, 40, 23,
    39, 51, 60, 67, 73, 79, 83, 87, 91, 94, 97, 100, 102, 105, 107, 111, 115, 118, 121, 124, 126,
    129, 131, 135, 139, 142, 145, 148, 150, 153, 155, 159, 163, 166, 169, 172, 174, 177, 179, 35,
    28, 49, 65, 78, 89, 99, 107, 114, 120, 126, 132, 136, 141, 145, 149, 153, 159, 165, 171, 176,
    180, 185, 189, 192, 199, 205, 211, 216, 220, 225, 229, 232, 239, 245, 251, 21, 33, 58, 79, 97,
    112, 125, 137, 148, 157, 166, 174, 182, 189, 195, 201, 207, 217, 227, 235, 243, 251, 17, 35,
    63, 86, 106, 123, 139, 152, 165, 177, 187, 197, 206, 214, 222, 230, 237, 250, 25, 31, 55, 75,
    91, 105, 117, 128, 138, 146, 154, 161, 168, 174, 180, 185, 190, 200, 208, 215, 222, 229, 235,
    240, 245, 255, 16, 36, 65, 89, 110, 128, 144, 159, 173, 185, 196, 207, 217, 226, 234, 242, 250,
    11, 41, 74, 103, 128, 151, 172, 191, 209, 225, 241, 255, 9, 43, 79, 110, 138, 163, 186, 207,
    227, 246, 12, 39, 71, 99, 123, 144, 164, 182, 198, 214, 228, 241, 253, 9, 44, 81, 113, 142,
    168, 192, 214, 235, 255, 7, 49, 90, 127, 160, 191, 220, 247, 6, 51, 95, 134, 170, 203, 234, 7,
    47, 87, 123, 155, 184, 212, 237, 6, 52, 97, 137, 174, 208, 240, 5, 57, 106, 151, 192, 231, 5,
    59, 111, 158, 202, 243, 5, 55, 103, 147, 187, 224, 5, 60, 113, 161, 206, 248, 4, 65, 122, 175,
    224, 4, 67, 127, 182, 234,
];

const CACHE_CAPS: [u8; 168] = [
    224, 224, 224, 224, 224, 224, 224, 224, 160, 160, 160, 160, 185, 185, 185, 178, 178, 168, 134,
    61, 37, 224, 224, 224, 224, 224, 224, 224, 224, 240, 240, 240, 240, 207, 207, 207, 198, 198,
    183, 144, 66, 40, 160, 160, 160, 160, 160, 160, 160, 160, 185, 185, 185, 185, 193, 193, 193,
    183, 183, 172, 138, 64, 38, 240, 240, 240, 240, 240, 240, 240, 240, 207, 207, 207, 207, 204,
    204, 204, 193, 193, 180, 143, 66, 40, 185, 185, 185, 185, 185, 185, 185, 185, 193, 193, 193,
    193, 193, 193, 193, 183, 183, 172, 138, 65, 39, 207, 207, 207, 207, 207, 207, 207, 207, 204,
    204, 204, 204, 201, 201, 201, 188, 188, 176, 141, 66, 40, 193, 193, 193, 193, 193, 193, 193,
    193, 193, 193, 193, 193, 194, 194, 194, 184, 184, 173, 139, 65, 39, 204, 204, 204, 204, 204,
    204, 204, 204, 201, 201, 201, 201, 198, 198, 198, 187, 187, 175, 140, 66, 40,
];

/// Opus mode.
pub(crate) struct Mode {
    fs: u32,
    overlap: usize,
    nb_ebands: usize,
    eff_bands: usize,
    preemph: [f32; 4],
    // Definition for each "pseudo-critical band"
    e_bands: Box<[u8]>,

    max_lm: usize,
    nb_short_mdcts: usize,
    short_mdct_size: usize,

    // Number of lines in the matrix below.
    nb_alloc_vectors: usize,
    // Number of bits in each band for several rates
    alloc_vectors: Box<[u8]>,
    log_n: Box<[u8]>,

    window: [f32; 120],
    mdct: Mdct,
    cache: PulseCache,
}

/// Pulse cache.
pub(crate) struct PulseCache {
    size: usize,
    index: Box<[i16]>,
    bits: Box<[u8]>,
    caps: Box<[u8]>,
}

// TODO not sure yet if the modes really can be non mutable and can have static lifetime.
impl Default for Mode {
    fn default() -> Self {
        Self {
            fs: 48000,
            overlap: 120,
            nb_ebands: 21,
            eff_bands: 21,
            preemph: [0.8500061, 0.0, 1.0, 1.0],
            e_bands: Box::from(E_BAND),
            max_lm: 3,
            nb_short_mdcts: 8,
            short_mdct_size: 120,
            nb_alloc_vectors: 11,
            alloc_vectors: Box::from(ALLOC_VECTORS),
            log_n: Box::from(LOG_N),
            window: WINDOW,
            mdct: Mdct {
                n: 1920,
                max_shift: 3,
                kfft: Box::from(KFFT),
                trig: Box::from(TWIDDLES),
            },
            cache: PulseCache {
                size: 392,
                index: Box::from(CACHE_INDEX),
                bits: Box::from(CACHE_BITS),
                caps: Box::from(CACHE_CAPS),
            },
        }
    }
}
